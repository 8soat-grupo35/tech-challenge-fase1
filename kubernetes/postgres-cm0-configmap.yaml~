apiVersion: v1
data:
  docker-database-initial.sql: "CREATE TABLE IF NOT EXISTS customers(\n    id serial primary key,\n    name varchar(255) NOT NULL,\n    email varchar(255) NOT NULL,\n    cpf varchar(11) NOT NULL,\n    created_at timestamptz NULL,\n\tupdated_at timestamptz NULL,\n\tdeleted_at timestamptz NULL\n);\n\nCREATE TABLE IF NOT EXISTS items(\n    id serial primary key,\n    name varchar(255) NOT NULL,\n    category varchar(30) NOT NULL,\n    price numeric NOT NULL,\n    image_url varchar(255) NOT NULL,\n    created_at timestamptz NULL,\n\tupdated_at timestamptz NULL,\n\tdeleted_at timestamptz NULL\n);\n\nCREATE TABLE IF NOT EXISTS orders(\n    id serial primary key,\n    status varchar(50) NOT NULL,\n    customer_id int NOT NULL,\n    created_at timestamptz NULL,\n\tupdated_at timestamptz NULL,\n\tdeleted_at timestamptz NULL,\n\n    CONSTRAINT fk_customer_orders\n      FOREIGN KEY(customer_id) \n      REFERENCES customers(id)\n      ON DELETE SET NULL\n);\n\nCREATE TABLE IF NOT EXISTS payment_statuses(\n     id serial primary key,\n     name varchar(100) NOT NULL,\n     created_at timestamptz NULL,\n     updated_at timestamptz NULL,\n     deleted_at timestamptz NULL\n);\n\nCREATE TABLE IF NOT EXISTS order_payments(\n    id serial primary key,\n    order_id int NOT NULL,\n    payment_status_id int NOT NULL,\n    created_at timestamptz NULL,\n    updated_at timestamptz NULL,\n    deleted_at timestamptz NULL,\n\n    CONSTRAINT fk_order_payments\n        FOREIGN KEY(order_id)\n        REFERENCES orders(id)\n        ON DELETE SET NULL,\n    CONSTRAINT fk_order_payments_statuses\n        FOREIGN KEY(payment_status_id)\n        REFERENCES payment_statuses(id)\n        ON DELETE SET NULL\n);\n\nCREATE TABLE IF NOT EXISTS order_items(\n    id serial primary key,\n    order_id int NOT NULL,\n    item_id int NOT NULL,\n    quantity int NOT NULL,\n    created_at timestamptz NULL,\n\tupdated_at timestamptz NULL,\n\tdeleted_at timestamptz NULL,\n\n    CONSTRAINT fk_order_orders_items\n      FOREIGN KEY(order_id) \n      REFERENCES orders(id)\n      ON DELETE SET NULL,\n\n    CONSTRAINT fk_item_orders_items\n      FOREIGN KEY(item_id) \n      REFERENCES items(id)\n      ON DELETE SET NULL\n);\n\nINSERT INTO items (name, category, price, image_url, created_at, updated_at, deleted_at) VALUES ('X-Burguer', 'LANCHE', 28, 'https://fastly.picsum.photos/id/8/200/200.jpg?hmac=7z37E8o2M_U09oSFIN5CdqKXlYXuLeWxTHJVlT9UUlY', 'NOW'::timestamptz, 'NOW'::timestamptz, null);\n\nINSERT INTO items (name, category, price, image_url, created_at, updated_at, deleted_at) VALUES ('X-Bacon', 'LANCHE', 35, 'https://fastly.picsum.photos/id/8/200/200.jpg?hmac=7z37E8o2M_U09oSFIN5CdqKXlYXuLeWxTHJVlT9UUlY', 'NOW'::timestamptz, 'NOW'::timestamptz, null);\n\nINSERT INTO customers (name, email, cpf, created_at, updated_at, deleted_at) VALUES ('John Doe', 'john@gmail.com', '12345678911', 'NOW'::timestamptz, 'NOW'::timestamptz, null);\n\nINSERT INTO payment_statuses (name) VALUES ('AGUARDANDO');\nINSERT INTO payment_statuses (name) VALUES ('RECUSADO');\nINSERT INTO payment_statuses (name) VALUES ('APROVADO');"
kind: ConfigMap
metadata:
  annotations:
    use-subpath: "true"
  labels:
    io.kompose.service: postgres
  name: postgres-cm0
